<!--Web App-->
@if (!isMobile) {
	<div>
		<h2 class="text-dark">{{ pageTitle }}</h2>

		<!-- Filter pills -->
		<div class="filter-bar mb-4 mt-3">
			@for (f of filters; track f) {
				<button
					class="filter-pill"
					[class.active]="f === activeFilter"
					(click)="applyFilter(f)"
				>
					{{ f }}
				</button>
			}
		</div>

		@for (
			study of filteredStudies;
			track study;
			let i = $index;
			let last = $last
		) {
			<div
				class="row p-4 m-2"
				[class.border-bottom]="!last"
				[class.mt-4]="i > 0"
			>
				<div class="col-4">
					<img
						[src]="study.img_url"
						style="
							width: 100%;
							height: 220px;
							object-fit: cover;
							border-radius: 8px;
						"
						[alt]="study.name"
					/>
				</div>
				<div class="col p-4 text-center">
					<h3
						class="text-dark"
						style="font-family: 'Lato', sans-serif"
					>
						<u>{{ study.name }}</u>
					</h3>
					<p class="text-secondary mb-1">
						<i class="fas fa-building me-1"></i>{{ study.client }}
					</p>
					<p class="text-dark mt-2">{{ study.description }}</p>
					<div class="mt-3">
						<button
							class="btn btn-sm"
							[class.btn-outline-primary]="openDocIndex !== i"
							[class.btn-outline-danger]="openDocIndex === i"
							(click)="toggleDoc(i)"
						>
							<i
								class="me-2"
								[class.fas]="true"
								[class.fa-file-pdf]="openDocIndex !== i"
								[class.fa-times-circle]="openDocIndex === i"
							></i
							>{{
								openDocIndex === i ? 'Hide Docs' : 'Read Docs'
							}}
						</button>
					</div>
				</div>
			</div>
			<!-- Inline PDF viewer -->
			@if (openDocIndex === i) {
				<div class="pdf-viewer-wrapper mt-2 mb-4 mx-2">
					<ngx-extended-pdf-viewer
						[src]="study.docUrl"
						[height]="'70vh'"
						[textLayer]="false"
						[showToolbar]="false"
						[showSidebarButton]="false"
						[showFindButton]="false"
						[showPagingButtons]="true"
						[showZoomButtons]="true"
						[showPresentationModeButton]="true"
						[showDrawEditor]="false"
						[showStampEditor]="false"
						[showTextEditor]="false"
						[showHighlightEditor]="false"
						[showOpenFileButton]="false"
						[showPrintButton]="false"
						[showDownloadButton]="false"
						[showSecondaryToolbarButton]="false"
						[showRotateButton]="false"
						[showHandToolButton]="false"
						[showSpreadButton]="false"
						[showPropertiesButton]="false"
						[enableDragAndDrop]="false"
						[showBookModeButton]="false"
						[showSinglePageModeButton]="false"
						[enablePrint]="false"
						[contextMenuAllowed]="false"
					>
					</ngx-extended-pdf-viewer>
				</div>
			}
		}

		@if (filteredStudies.length === 0) {
			<p class="text-center text-secondary mt-5">
				No work items match this filter.
			</p>
		}
	</div>
}

<!--Mobile App-->
@if (isMobile) {
	<div>
		<h2 class="text-dark text-center">{{ pageTitleMobile }}</h2>

		<!-- Filter pills (mobile) -->
		<div class="filter-bar filter-bar-mobile mb-3 mt-2">
			@for (f of filters; track f) {
				<button
					class="filter-pill"
					[class.active]="f === activeFilter"
					(click)="applyFilter(f)"
				>
					{{ f }}
				</button>
			}
		</div>

		@for (
			study of filteredStudies;
			track study;
			let i = $index;
			let last = $last
		) {
			<div
				class="row p-3 m-2"
				[class.border-bottom]="!last"
				[class.mt-3]="i > 0"
			>
				<div class="row-4">
					<img
						[src]="study.img_url"
						style="
							width: 100%;
							height: 180px;
							object-fit: cover;
							border-radius: 8px;
						"
						[alt]="study.name"
					/>
				</div>
				<div class="text-center mt-2">
					<h5
						class="text-dark"
						style="font-family: 'Lato', sans-serif"
					>
						<u>{{ study.name }}</u>
					</h5>
					<p class="text-secondary mb-1">
						<i class="fas fa-building me-1"></i>{{ study.client }}
					</p>
					<p class="text-dark mt-2">{{ study.description }}</p>
					<div class="mt-2">
						<button
							class="btn btn-sm"
							[class.btn-outline-primary]="openDocIndex !== i"
							[class.btn-outline-danger]="openDocIndex === i"
							(click)="toggleDoc(i)"
						>
							<i
								class="me-2"
								[class.fas]="true"
								[class.fa-file-pdf]="openDocIndex !== i"
								[class.fa-times-circle]="openDocIndex === i"
							></i
							>{{
								openDocIndex === i ? 'Hide Docs' : 'Read Docs'
							}}
						</button>
					</div>
				</div>
			</div>
			<!-- Inline PDF viewer -->
			@if (openDocIndex === i) {
				<div class="pdf-viewer-wrapper mt-2 mb-3 mx-2">
					<ngx-extended-pdf-viewer
						[src]="study.docUrl"
						[height]="'50vh'"
						[textLayer]="false"
						[showToolbar]="true"
						[showSidebarButton]="false"
						[showFindButton]="false"
						[showPagingButtons]="true"
						[showZoomButtons]="true"
						[showPresentationModeButton]="true"
						[showDrawEditor]="false"
						[showStampEditor]="false"
						[showTextEditor]="false"
						[showHighlightEditor]="false"
						[showOpenFileButton]="false"
						[showPrintButton]="false"
						[showDownloadButton]="false"
						[showSecondaryToolbarButton]="false"
						[showRotateButton]="false"
						[showHandToolButton]="false"
						[showSpreadButton]="false"
						[showPropertiesButton]="false"
						[enableDragAndDrop]="false"
						[showBookModeButton]="false"
						[showSinglePageModeButton]="false"
						[enablePrint]="false"
						[contextMenuAllowed]="false"
					>
					</ngx-extended-pdf-viewer>
				</div>
			}
		}

		@if (filteredStudies.length === 0) {
			<p class="text-center text-secondary mt-4">
				No work items match this filter.
			</p>
		}
	</div>
}
